#!/usr/bin/env bash

type="$1"
accession="$2"
base="$BTK_DATA"/ncbi/geo

usage() {
    echo "USAGE: dataset matrix [probe|gene|taxon] <accession>" 1>&2
    exit 1
}

[ $# != 2 ] && usage

case $type in
    probe) path=matrix/probe/${accession}.gz ;;
    gene) path=matrix/gene/${accession}.gz ;;
    taxon) path=matrix/taxon/${accession}.gz ;;
    ?) usage ;;
esac

make -C "$base" -f $(realpath $(dirname $0)/mk/matrix.make) $path 1>&2
zcat -f "$base"/$path
